<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>External File Definition of Factory &mdash; random-obj-generator 0.17.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/my_theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Run as Command" href="doc.as_command.html" />
    <link rel="prev" title="Output Generated Values" href="doc.write_generated.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            random-obj-generator
          </a>
              <div class="version">
                0.17.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="doc.quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.construct_factories.html">Construct Factories (generator of random values)</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.use_factories.html">Use Factories</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.write_generated.html">Output Generated Values</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">External File Definition of Factory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#attributes">Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#importable-definition-files">Importable definition files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="doc.as_command.html">Run as Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.tips.html">Tips (Usage)</a></li>
<li class="toctree-l1"><a class="reference internal" href="randog.html">randog package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">random-obj-generator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">External File Definition of Factory</li>
    <li class="spacer"></li>
    <li class="wy-breadcrumbs-aside">
        <select name="lang" onchange="location.href=value;">
            <option value="../en/doc.external_def.html"
                selected
            >English</option>
            <option value="../ja/doc.external_def.html"
            >日本語</option>
        </select>
    </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="external-file-definition-of-factory">
<h1>External File Definition of Factory<a class="headerlink" href="#external-file-definition-of-factory" title="Permalink to this heading"></a></h1>
<p>In most generation of factories described so far, the definition of factory was directly described in the python file executed, but factories can also be generated by describing them in an external file and loading that file at runtime.</p>
<p>The external definition file is written as follows, in python code, so that the generated factory is bound to the variable <code class="code docutils literal notranslate"><span class="pre">FACTORY</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uuid</span>

<span class="n">FACTORY</span> <span class="o">=</span> <span class="n">randog</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">from_example</span><span class="p">({</span>
    <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># (optional) Settings used by &#39;byfile&#39; mode of command executing</span>
<span class="n">CSV_COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]</span>
<span class="n">OUTPUT_LINESEP</span> <span class="o">=</span> <span class="s2">&quot;LF&quot;</span>
<span class="n">OUTPUT_ENCODING</span> <span class="o">=</span> <span class="s2">&quot;utf8&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In factory definition file, <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">randog</span></code> can be omitted.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As discussed below, <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">randog</span></code> cannot be omitted if the factory definition file is used as python code other than in from_pyfile or byfile mode.</p>
</div>
</div>
<p>If you save this file under the name <code class="code docutils literal notranslate"><span class="pre">factory_def.py</span></code>, you can use it in your python code as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">randog.factory</span>

<span class="c1"># load factory definition</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">randog</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="s2">&quot;./factory_def.py&quot;</span><span class="p">)</span>

<span class="n">generated</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">generated</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The definition file can also be used when executing randog as command in byfile mode such as <code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">randog</span> <span class="pre">byfile</span> <span class="pre">./factory_def.py</span></code>. See also <a class="reference internal" href="doc.as_command.byfile.html"><span class="doc">byfile Mode</span></a>.</p>
</div>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading"></a></h2>
<p>The following attributes are defined in external definition file.</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">FACTORY</span></code>: <a class="reference internal" href="randog.factory.html#randog.factory.Factory" title="randog.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a></p>
<blockquote>
<div><ul class="simple">
<li><p>the factory to be loaded when using <a class="reference internal" href="randog.factory.html#randog.factory.from_pyfile" title="randog.factory.from_pyfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_pyfile</span></code></a> and to be used when executing randog as command in byfile mode.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">CSV_COLUMNS</span></code>: list[str | (dict) -&gt; Any], optional</p>
<blockquote>
<div><ul class="simple">
<li><p>the definitions of each column value. If it is defined with str, the value is taken from the generated object using that as the key. If it is defined with a function, the function is used with the generated object as an argument, and the return value is used.</p></li>
<li><p>This attribute is used when executing commands in byfile mode. See also <a class="reference internal" href="doc.as_command.byfile.html"><span class="doc">byfile Mode</span></a>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">OUTPUT_LINESEP</span></code>: ‘CRLF’ | ‘LF’ | ‘CR’, optional</p>
<blockquote>
<div><ul class="simple">
<li><p>line separator for output.</p></li>
<li><p>This attribute is used when executing commands in byfile mode outputs to a file with the <code class="code docutils literal notranslate"><span class="pre">--output</span></code>/<code class="code docutils literal notranslate"><span class="pre">-O</span></code> option. If the <code class="code docutils literal notranslate"><span class="pre">--output-linesep</span></code>/<code class="code docutils literal notranslate"><span class="pre">--O-ls</span></code> option is specified, that takes precedence. See also <a class="reference internal" href="doc.as_command.common_option.html"><span class="doc">Common Options</span></a>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">OUTPUT_ENCODING</span></code>: str, optional</p>
<blockquote>
<div><ul class="simple">
<li><p>encoding for output, such as ‘utf-8’.</p></li>
<li><p>This attribute is used when executing commands in byfile mode outputs to a file with the <code class="code docutils literal notranslate"><span class="pre">--output</span></code>/<code class="code docutils literal notranslate"><span class="pre">-O</span></code> option. If the <code class="code docutils literal notranslate"><span class="pre">--output-encoding</span></code>/<code class="code docutils literal notranslate"><span class="pre">-X</span></code> option is specified, that takes precedence. See also <a class="reference internal" href="doc.as_command.common_option.html"><span class="doc">Common Options</span></a>.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="importable-definition-files">
<span id="id1"></span><h2>Importable definition files<a class="headerlink" href="#importable-definition-files" title="Permalink to this heading"></a></h2>
<p>Since the definition file is written in python, it can be imported from other python files, but there are some points to note if it is intended to be imported.</p>
<p>For example, see the definition file below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">randog</span>

<span class="n">CSV_COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>

<span class="c1"># other python file can import and reuse this</span>
<span class="k">def</span> <span class="nf">create_factory</span><span class="p">(</span><span class="n">initial_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">randog</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">randdict</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="n">randog</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="n">initial_id</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="n">randog</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">randstr</span><span class="p">(),</span>
    <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__randog__&quot;</span><span class="p">:</span>
    <span class="n">initial_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;INITIAL_ID&quot;</span><span class="p">])</span>
    <span class="n">FACTORY</span> <span class="o">=</span> <span class="n">create_factory</span><span class="p">(</span><span class="n">initial_id</span><span class="p">)</span>
</pre></div>
</div>
<p>The following points are noted in this definition file to make it importable:</p>
<ul>
<li><p>write <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">randog</span></code>; This can only be omitted when this file is executed directly in from_pyfile or byfile mode of command execution, not when it is imported.</p></li>
<li><p>write the process that should not be executed at import in <code class="code docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__randog__&quot;</span></code>; If this is not done, and the environment variable INITIAL_ID is not set or contains non-numbers when imported, an exception will be raised and the python code importing this file will not be executable.</p>
<blockquote>
<div><ul class="simple">
<li><p>You can avoid it by other means, such as proper handling of exceptions. Choose the method appropriate to your situation.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="doc.write_generated.html" class="btn btn-neutral float-left" title="Output Generated Values" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="doc.as_command.html" class="btn btn-neutral float-right" title="Run as Command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, k-izumi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>